<!DOCTYPE html>
<html lang="en"><head>
<script src="02-IV_pt_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-IV_pt_files/libs/quarto-html/tabby.min.js"></script>
<script src="02-IV_pt_files/libs/quarto-html/popper.min.js"></script>
<script src="02-IV_pt_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="02-IV_pt_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-IV_pt_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="02-IV_pt_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="02-IV_pt_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.361">

  <meta name="author" content="Rafael Bressan">
  <title>Econometria III</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="02-IV_pt_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="02-IV_pt_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="02-IV_pt_files/libs/revealjs/dist/theme/quarto.css">
  <link href="02-IV_pt_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="02-IV_pt_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="02-IV_pt_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="02-IV_pt_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="02-IV_pt_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="02-IV_pt_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/UdescEsag.jpeg" data-background-position="top left" data-background-size="50%" class="quarto-title-block center">
  <h1 class="title">Econometria III</h1>
  <p class="subtitle">Variáveis Instrumentais</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Rafael Bressan 
</div>
</div>
</div>

</section>
<section id="preparando-a-cena" class="slide level2">
<h2>Preparando a cena</h2>
<ul>
<li class="fragment"><p>Nos capítulos <a href="https://scpoecon.github.io/ScPoEconometrics/causality.html">7</a>, <a href="https://scpoecon.github.io/ScPoEconometrics/STAR.html">8</a> e <a href="https%20://scpoecon.github.io/ScPoEconometrics/RDD.html">9</a> do livro <code>Introduction to Econometrics with R</code> é falado sobre os méritos dos <em>métodos experimentais</em>.</p></li>
<li class="fragment"><p>Experimentos aleatorizados (RCTs) ou configurações <em>Quasi-experimentais</em> (tão bons quanto aleatórios) nos permitem estimar efeitos <strong>causais</strong>.</p></li>
<li class="fragment"><p>Se as pessoas tiverem algum tipo de opção sobre a ingestão do tratamento, haverá <em>seleção</em>.</p></li>
<li class="fragment"><p>RCTs podem quebrar a auto-seleção de pessoas em tratamento, designando-as aleatoriamente.</p></li>
<li class="fragment"><p>Então, com dados experimentais, temos uma boa solução.</p></li>
<li class="fragment"><p>E os dados não experimentais?</p></li>
</ul>
</section>
<section id="dados-não-experimentais" class="slide level2">
<h2>Dados não experimentais</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Falamos sobre <strong>viés de variável omitida</strong>.</p></li>
<li class="fragment"><p>E se houver correlação entre uma variável no termo de erro <span class="math inline">\(u\)</span>, <span class="math inline">\(x_2\)</span> digamos, e nossa variável explicativa <span class="math inline">\(x_1\)</span>?</p></li>
<li class="fragment"><p>Obteremos estimativas tendenciosas porque não podemos separar o que é o quê: efeito de <span class="math inline">\(x_1\)</span>, ou de <span class="math inline">\(x_2\)</span>?</p></li>
<li class="fragment"><p>Lembre-se de que isso pode ser tão grave que nem conseguimos o sinal correto de um efeito.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/IV_ovb_dag.png"></p>
</div>
</div>
<center>
<ul>
<li class="fragment"><strong>VI</strong> fornece uma solução para VVO.</li>
</ul>
</center>
</section>
<section id="endogeneidade" class="slide level2">
<h2>Endogeneidade</h2>
<ul>
<li class="fragment">Sempre que uma variável explicativa em uma regressão múltipla for <strong>correlacionada com o termo de erro</strong>, dizemos que esta variável é <strong>endógena</strong></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
y=\beta_0+\beta_1 x_1 + \beta_2 x_2 + \ldots + \beta_k x_k + \varepsilon
\]</span></p>
</div>
<ul>
<li class="fragment"><p><span class="math inline">\(E[\varepsilon \mid x_1, \ldots x_k]\neq 0\)</span></p></li>
<li class="fragment"><p>Endogeneidade pode ocorrer por diversos motivos:</p>
<ul>
<li class="fragment">Forma funcional mal especificada</li>
<li class="fragment">Omissão de variável relevante</li>
<li class="fragment">Erro de medida nos regressores</li>
<li class="fragment">Determinação simultânea entre variável dependente e independentes</li>
</ul></li>
</ul>
</section>
<section id="rct-resolve-endogeneidade" class="slide level2">
<h2>RCT Resolve Endogeneidade</h2>
<ul>
<li class="fragment"><p>Considere uma especifcação linear para estimar o efeito causal de <span class="math inline">\(x\)</span> em <span class="math inline">\(y\)</span> <span class="math display">\[y=\beta_0 +\beta_1 x + \varepsilon\]</span></p></li>
<li class="fragment"><p>Com <strong>dados observacionais</strong> é fácil imaginar que omitimos diversas variáveis que ajudam a explicar <span class="math inline">\(y\)</span> e são correlacionadas com <span class="math inline">\(x\)</span>. <span class="math inline">\(E[\varepsilon\mid x]\neq 0\)</span>.</p>
<ul>
<li class="fragment"><span class="emoji" data-emoji="warning">⚠️</span> <strong>Endogeneidade</strong></li>
</ul></li>
<li class="fragment"><p>Quando realizamos um experimento aleatorizado, <span class="math inline">\(x\)</span> para a ser uma variável atribuída de forma <strong>independente</strong> de qualquer outro possível regressor omitido. <span class="math inline">\(E[\varepsilon\mid x]=0\)</span>.</p>
<ul>
<li class="fragment"><span class="math inline">\(x\)</span> passou a ser um regressor <strong>exógeno</strong></li>
<li class="fragment"><span class="math inline">\(\beta_1\)</span> pode ser interpretado como efeito causal de <span class="math inline">\(x\)</span> em <span class="math inline">\(y\)</span></li>
</ul></li>
</ul>
</section>
<section id="modelo-de-transmissão-do-cólera-de-snow" class="slide level2">
<h2>Modelo de Transmissão do Cólera de Snow</h2>
<ul>
<li class="fragment"><p>Suponha que <span class="math inline">\(c_i\)</span> assuma o valor 1 se o indivíduo <span class="math inline">\(i\)</span> morrer de cólera, 0 caso contrário.</p></li>
<li class="fragment"><p>Seja <span class="math inline">\(w_i = 1\)</span> significando que o abastecimento de água de <span class="math inline">\(i\)</span> é impuro e <span class="math inline">\(w_i = 0\)</span> vice-versa. A pureza da água é avaliada com uma tecnologia que não detecta pequenos micróbios.</p></li>
<li class="fragment"><p>Colete em <span class="math inline">\(u_i\)</span> todos os fatores não observáveis que afetam a probabilidade de <span class="math inline">\(i\)</span> morrer da doença: se <span class="math inline">\(i\)</span> é pobre, onde exatamente eles residem, se há má qualidade do ar nos arredores de <span class="math inline">\(i\)</span> e outras características individuais que impactam o resultado (como configuração genética de <span class="math inline">\(i\)</span>).</p></li>
</ul>
<div class="fragment">
<p>Nós podemos escrever:</p>
<p><span class="math display">\[
c_i = \alpha + \delta w_i + u_i
\]</span></p>
</div>
</section>
<section id="fazer-o-simples-é-sempre-certo" class="slide level2">
<h2>Fazer o simples é sempre certo?</h2>
<ul>
<li class="fragment"><p>John Snow poderia ter usado seus dados e avaliar a correlação entre beber água impura e a incidência de cólera.</p></li>
<li class="fragment"><p>medida <span class="math inline">\(Cor(c_i,w_i)\)</span></p></li>
<li class="fragment"><p>Suponha <span class="math inline">\(Cor(c_i,w_i) \approx 0,5\)</span>. Isso prova a teoria da infecção?</p></li>
<li class="fragment"><p><span class="emoji" data-emoji="warning">⚠️</span> Não é bem assim. Angus Deaton disse:</p></li>
</ul>
<div class="fragment">
<blockquote>
<p>As pessoas que bebiam água impura também eram mais propensas a serem pobres e a viver em um ambiente contaminado de várias maneiras, principalmente pelos “miasmas venenosos” que eram então considerados a causa da cólera.</p>
</blockquote>
</div>
</section>
<section id="a-coisa-simples" class="slide level2">
<h2>A coisa simples</h2>
<ul>
<li class="fragment"><p>Não faz sentido comparar alguém que bebe água pura com alguém que bebe água impura.</p></li>
<li class="fragment"><p>porque <em>tudo o mais não é igual</em>: a água impura está correlacionada com ser pobre, morar em área ruim, má qualidade do ar e assim por diante - todos os fatores que encontramos em <span class="math inline">\(u_i\)</span>.</p></li>
<li class="fragment"><p>Isso viola a suposição crucial de ortogonalidade para estimativas MQO válidas, <span class="math inline">\(E[u_i | w_i]=0\)</span> neste contexto.</p></li>
<li class="fragment"><p>Outra maneira de dizer isso é que <span class="math inline">\(Cov(w_i, u_i) \neq 0\)</span>, implicando que <span class="math inline">\(w_i\)</span> é <strong><em>endógeno</em></strong>.</p></li>
<li class="fragment"><p>Existem fatores em <span class="math inline">\(u_i\)</span> que afetam tanto <span class="math inline">\(w_i\)</span> quanto <span class="math inline">\(c_i\)</span></p></li>
</ul>
</section>
<section id="modelo-de-snow-e-um-pouco-de-álgebra" class="slide level2">
<h2>Modelo de Snow e um pouco de álgebra</h2>
<p>Lembre-se do nosso modelo simples: <span class="math display">\[c_i = \alpha + \delta w_i + u_i\]</span></p>
<ul>
<li class="fragment"><p>Agora vamos condicionar os dois valores de <span class="math inline">\(w\)</span>: <span class="math display">\[\begin{align}
E[c_i | w_i = 1] &amp;= \alpha + \delta + E[u_i | w_i = 1] \\
E[c_i | w_i = 0] &amp;= \alpha + \phantom{\delta} + E[u_i | w_i = 0]
\end{align}\]</span></p></li>
<li class="fragment"><p>Agora subtraia uma linha da outra: <span class="math display">\[\begin{equation}
E[c_i | w_i = 1] - E[c_i | w_i = 0] = \delta + \left\{ E[u_i | w_i = 1] - E[u_i | w_i = 0]\right\}
\end{equation}\]</span></p></li>
<li class="fragment"><p>O último termo <span class="math inline">\(\left\{ E[u_i | w_i = 1] - E[u_i | w_i = 0]\right\}\)</span> não é igual a zero (pelo que Deaton disse!)</p></li>
<li class="fragment"><p>Uma estimativa de regressão para <span class="math inline">\(\delta\)</span> seria influenciada por essa quantidade.</p></li>
</ul>
</section>
<section id="estimador-de-variáveis-instrumentais" class="slide level2">
<h2>Estimador de Variáveis Instrumentais</h2>
<ul>
<li class="fragment"><p>Snow propõe uma <strong>variável instrumental</strong> <span class="math inline">\(z_i\)</span>, a <em>identidade da empresa fornecedora de água</em> para o domicílio <span class="math inline">\(i\)</span>:</p></li>
<li class="fragment"><p>Mais formalmente, vamos definir o instrumento da seguinte forma:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[\begin{align*}
z_i &amp;= \begin{cases}
                     1 &amp; \text{se água fornecida por Lambeth} \\
                     0 &amp; \text{se água fornecida por Southwark ou Vauxhall.} \\
       \end{cases} \\
\end{align*}\]</span></p>
</div>
<ul>
<li class="fragment"><p><span class="math inline">\(z_i\)</span> está altamente correlacionado com a pureza da água <span class="math inline">\(w_i\)</span>.</p></li>
<li class="fragment"><p>No entanto, parece não ter correlação com todos os outros fatores em <span class="math inline">\(u_i\)</span>, que nos preocupavam antes: o abastecimento de água foi decidido anos antes, e agora as casas na mesma rua têm fornecedores diferentes!</p></li>
</ul>
</section>
<section id="vi-em-um-dag" class="slide level2">
<h2>VI em um DAG</h2>

<img data-src="img/IV-dag.png" class="r-stretch"></section>
<section id="definindo-a-vi-de-snow-formalmente" class="slide level2">
<h2>Definindo a VI de Snow formalmente</h2>
<p>Aqui estão as <strong><em>condições para um instrumento válido</em></strong>:</p>
<ol type="1">
<li class="fragment"><p><strong>Relevância</strong>: A pureza da água é, de fato, uma função da identidade do fornecedor. Queremos que <span class="math inline">\(E[w_i | z_i = 1] \neq E[w_i | z_i = 0]\)</span>, ou seja, a pureza média da água difere entre os fornecedores. Podemos <em>verificar</em> esta condição com dados observacionais.</p></li>
<li class="fragment"><p><strong>Independência</strong>: Se uma família tem <span class="math inline">\(z_i = 1\)</span> ou <span class="math inline">\(z_i = 0\)</span> não tem relação com <span class="math inline">\(u\)</span>, portanto <span class="math inline">\(z\)</span> é <em>tão bom quanto aleatório</em>. Se condicionarmos <span class="math inline">\(u\)</span> a certos valores de <span class="math inline">\(z\)</span> não altera o resultado - queremos <span class="math inline">\(E[u_i | z_i = 1] = E[u_i | z_i = 0].\)</span></p></li>
<li class="fragment"><p><strong>Exclusividade</strong> o instrumento deve afetar o resultado <span class="math inline">\(c\)</span> <em>somente</em> através do canal especificado (ou seja, através da pureza da água <span class="math inline">\(w\)</span>), e nada mais.</p></li>
</ol>
</section>
<section id="definindo-o-estimador-de-vi" class="slide level2">
<h2>Definindo o estimador de VI</h2>
<ul>
<li class="fragment"><p>Agora estamos prontos para definir um estimador de VI simples. Como antes, vamos condicionar os valores de <span class="math inline">\(z\)</span>: <span class="math display">\[\begin{align}
E[c_i | z_i = 1] &amp;= \alpha + \delta E[w_i | z_i = 1] + E[u_i | z_i = 1] \\
E[c_i | z_i = 0] &amp;= \alpha + \delta E[w_i | z_i = 0] + E[u_i | z_i = 0]
\end{align}\]</span></p></li>
<li class="fragment"><p>tomando a diferença entre as expressões: <span class="math display">\[\begin{align}
E[c_i | z_i = 1] - E[c_i | z_i = 0] &amp;= \delta \left\{ E[w_i | z_i = 1] - E[w_i | z_i = 0]\right\} \\
&amp;+ \underbrace{\left\{ E[u_i | z_i = 1] - E[u_i | z_i = 0] \right\}}_{=0 \text{ por Indepedência}}
\end{align}\]</span></p></li>
<li class="fragment"><p>Finalmente, se a VI for <em>relevante</em>, ou seja, <span class="math inline">\(E[w_i | z_i = 1] - E[w_i | z_i = 0] \neq 0\)</span>: <span class="math display">\[\begin{equation}
\delta = \frac{E[c_i | z_i = 1] - E[c_i | z_i = 0]}{E[w_i | z_i = 1] - E[w_i | z_i = 0]}
\end{equation}\]</span></p></li>
</ul>
</section>
<section id="caso-especial-estimador-de-wald" class="slide level2">
<h2>Caso Especial: Estimador de Wald</h2>
<ul>
<li class="fragment"><p>Digamos que <span class="math inline">\(x \mapsto y\)</span> significa que <span class="math inline">\(x\)</span> é uma estimativa para <span class="math inline">\(y\)</span>:</p>
<ol type="1">
<li class="fragment"><span class="math inline">\(\overline{c}_1 \mapsto E[c_i | z_i = 1]\)</span>: a proporção de domicílios abastecidos por Lambeth com cólera.</li>
<li class="fragment"><span class="math inline">\(\overline{w}_1 \mapsto E[w_i | z_i = 1]\)</span>: a proporção de domicílios abastecidos por Lambeth com água ruim.</li>
<li class="fragment"><span class="math inline">\(\overline{c}_0 \mapsto E[c_i | z_i = 0]\)</span>: a proporção de domicílios não abastecidos por Lambeth com cólera.</li>
<li class="fragment"><span class="math inline">\(\overline{w}_0 \mapsto E[w_i | z_i = 0]\)</span>: a proporção de domicílios não abastecidos por Lambeth com água ruim.</li>
</ol></li>
<li class="fragment"><p>O estimador seria então <span class="math display">\[\begin{equation}
\hat{\delta} = \frac{\overline{c}_1 - \overline{c}_0}{\overline{w}_1 - \overline{w}_0}
\end{equation}\]</span></p></li>
<li class="fragment"><p>Neste caso especial onde todas as variáveis envolvidas <span class="math inline">\(c,w,z\)</span> são binárias, o estimador é chamado de <strong><em>estimador de Wald</em></strong>.</p></li>
</ul>
</section>
<section id="resumo" class="slide level2">
<h2>Resumo</h2>
<ul>
<li class="fragment"><p>VIs são uma ferramenta poderosa para estabelecer causalidade em contextos apenas com dados observacionais e onde estamos preocupados que a suposição de média condicional <span class="math inline">\(E[u_i | x_i]=0\)</span> é violado (<em>endogeneidade</em>).</p></li>
<li class="fragment"><p>As principais características da VI <span class="math inline">\(z\)</span> são que:</p>
<ol type="1">
<li class="fragment"><p><span class="math inline">\(z\)</span> é <em>relevante</em> para <span class="math inline">\(x\)</span>. Por exemplo, em uma regressão simples de <span class="math inline">\(z\)</span> em <span class="math inline">\(x\)</span>, queremos que <span class="math inline">\(z\)</span> tenha um poder preditivo considerável. Podemos <em>testar</em> essa condição nos dados.</p></li>
<li class="fragment"><p>Precisamos de uma teoria segundo a qual seja <em>razoável</em> supor que <span class="math inline">\(z\)</span> não esteja <em>relacionado</em> a outros fatores não observáveis que possam impactar o resultado. Portanto, <span class="math inline">\(z\)</span> é <em>exógeno</em> a <span class="math inline">\(u\)</span>, ou <span class="math inline">\(E[u | z] = 0\)</span>. Esta é uma <strong>suposição</strong> (ou seja, não podemos testar isso com dados).</p></li>
</ol></li>
</ul>
</section>
<section id="aplicações-de-variáveis-instrumentais" class="slide level2">
<h2>Aplicações de Variáveis Instrumentais</h2>
<ul>
<li class="fragment"><p>O que fizemos na aula passada?</p>
<ul>
<li class="fragment"><p>Aprendemos sobre o grande experimento de John Snow em Londres em 1850.</p></li>
<li class="fragment"><p>Usamos sua história para motivar o estimador IV.</p></li>
</ul></li>
<li class="fragment"><p>Hoje</p>
<ul>
<li class="fragment"><p>Veremos outras aplicações IV.</p></li>
<li class="fragment"><p>Introduzimos uma extensão chamada <strong><em>Mínimos Quadrados em 2 Estágios</em></strong>.</p></li>
<li class="fragment"><p>Usaremos <code>R</code> para calcular as estimativas.</p></li>
<li class="fragment"><p>Finalmente falaremos sobre instrumentos <em>fracos</em>.</p></li>
</ul></li>
</ul>
</section>
<section id="retornos-da-escolaridade" class="slide level2">
<h2>Retornos da Escolaridade</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Qual é o impacto causal da escolaridade sobre os rendimentos?</p></li>
<li class="fragment"><p><a href="https://en.wikipedia.org/wiki/Jacob_Mincer">Jacob Mincer</a> estava interessado nesta importante questão.</p></li>
<li class="fragment"><p>Aqui está o modelo dele: <span class="math display">\[
\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + e_i
\]</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/schooling-dag.png"></p>
</div>
</div>
</section>
<section id="retornos-da-escolaridade-1" class="slide level2">
<h2>Retornos da Escolaridade</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + e_i
\]</span></p>
<ul>
<li class="fragment"><p>Ele encontrou uma estimativa para <span class="math inline">\(\rho\)</span> de cerca de 0,11,</p></li>
<li class="fragment"><p>11% de vantagem nos ganhos para cada ano adicional de educação</p></li>
<li class="fragment"><p>Veja o DAG. Esse é um bom modelo? Bem, por que não seria?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/schooling-dag.png"></p>
</div>
</div>
</section>
<section id="viés-de-habilidade" class="slide level2">
<h2>Viés de Habilidade</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Comparamos os ganhos de homens com certa escolaridade e experiência de trabalho</p></li>
<li class="fragment"><p>Tudo o mais é igual, depois de controlar isso?</p></li>
<li class="fragment"><p>Dado <span class="math inline">\(X\)</span>,</p>
<ul>
<li class="fragment">Podemos encontrar trabalhadores mais ou menos diligentes por aí?</li>
<li class="fragment">Podemos encontrar trabalhadores com capacidades diferentes?</li>
<li class="fragment">As conexões familiares dos trabalhadores variam?</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Sim claro. Então, <em>todo o resto</em> não é igual.</p></li>
<li class="fragment"><p>Isso é um problema, porque para consistência dos MQO exigimos a suposição de ortogonalidade <span class="math display">\[E[e_i | S_i, X_i] = 0\]</span></p></li>
<li class="fragment"><p>Vamos introduzir a <strong>habilidade</strong> <span class="math inline">\(A_i\)</span> explicitamente.</p></li>
</ul>
</div>
</div>
</section>
<section id="mincer-com-habilidade-não-observada" class="slide level2">
<h2>Mincer com Habilidade não Observada</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Na verdade temos <em>dois</em> fatores não-observáveis: <span class="math inline">\(e\)</span> e <span class="math inline">\(A\)</span>.</p></li>
<li class="fragment"><p>Claro que não podemos distingui-los.</p></li>
<li class="fragment"><p>Então definimos um novo fator não observável <span class="math display">\[u_i = e_i + A_i\]</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/schooling-dag2.png"></p>
</div>
</div>
</section>
<section id="mincer-com-habilidade-não-observada-1" class="slide level2">
<h2>Mincer com Habilidade não Observada</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Em termos de uma equação: <span class="math display">\[\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + \underbrace{u_i}_{A_i + e_i}\]</span></p></li>
<li class="fragment"><p>Às vezes, isso não importa e o viés dos MQO é pequeno.</p></li>
<li class="fragment"><p>Às vezes importa, e a estimação é totalmente errada!</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/schooling-dag2.png"></p>
</div>
</div>
</section>
<section>
<section id="mecânica-das-variáveis-instrumentais" class="title-slide slide level1 center">
<h1>Mecânica das Variáveis Instrumentais</h1>

</section>
<section id="identificação" class="slide level2">
<h2>Identificação</h2>
<p>Vamos voltar ao nosso modelo linear simples:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x + u
\]</span></p>
<p>onde tememos que <span class="math inline">\(Cov(x,u) \neq 0\)</span>, <span class="math inline">\(x\)</span> seja <em>endógeno</em>.</p>
</section>
<section id="condições-para-vi" class="slide level2">
<h2>Condições para VI</h2>
<ol type="1">
<li class="fragment"><strong>Relevância do Instrumento</strong>: <span class="math inline">\(Cov(z,x) \neq 0\)</span></li>
<li class="fragment"><strong>Exogenidade do VI</strong> (restrição de exclusão): <span class="math inline">\(Cov(z,u) = 0\)</span>, a VI é exógena na equação do resultado.</li>
</ol>
</section>
<section id="modelo-válido-a-vs-modelo-inválido-b-para-vi-z" class="slide level2">
<h2>Modelo Válido (A) vs Modelo Inválido (B) para VI <code>z</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<p><img data-src="02-IV_pt_files/figure-revealjs/cell-3-output-1.png" width="979" height="519"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<p><img data-src="02-IV_pt_files/figure-revealjs/cell-4-output-1.png" width="979" height="519"></p>
</div>
</div>
</div>
</div>
</section>
<section id="identificação-1" class="slide level2">
<h2>Identificação</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Condições para VI</strong></p>
<ol type="1">
<li class="fragment"><strong>Relevância</strong>: <span class="math inline">\(Cov(z,x) \neq 0\)</span></li>
<li class="fragment"><strong>Exogeneidade</strong>: <span class="math inline">\(Cov(z,u) = 0\)</span></li>
</ol>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Como isto <strong><em>identifica</em></strong> <span class="math inline">\(\beta_1\)</span>?</p></li>
<li class="fragment"><p>Como podemos expressar <span class="math inline">\(\beta_1\)</span> em termos de momentos populacionais de forma única?</p></li>
</ul>
</div>
</div>
</section>
<section id="identificação-2" class="slide level2">
<h2>Identificação</h2>
<p><span class="math display">\[
\begin{aligned}
Cov(z,y) &amp;= Cov(z, \beta_0 + \beta_1 x + u) \\
         &amp;= \beta_1 Cov(z,x) + Cov(z,u)
\end{aligned}
\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Sob a condição 2. acima (<strong>restrição de exclusão</strong>), temos que <span class="math inline">\(Cov(z,u)=0\)</span>, então:</p>
<p><span class="math display">\[
Cov(z,y) = \beta_1 Cov(z,x)
\]</span></p>
</div><div class="column" style="width:50%;">
<p>e sob a condição 1. (<strong>relevância</strong>), temos <span class="math inline">\(Cov(z,x)\neq 0\)</span>, portanto:</p>
<p><span class="math display">\[
\beta_1 =  \frac{Cov(z,y)}{Cov(z,x)}.
\]</span></p>
</div>
</div>
<ul>
<li class="fragment"><p><span class="math inline">\(\beta_1\)</span> é <strong><em>identificado</em></strong> via os momentos populacionais <span class="math inline">\(Cov(z,y)\)</span> e <span class="math inline">\(Cov(z,x)\)</span></p></li>
<li class="fragment"><p>Podemos <strong><em>estimar</em></strong> estes momentos através dos <strong><em>análogos amostrais</em></strong> (<em>sample plugin estimator</em>)</p></li>
</ul>
</section>
<section id="estimador-de-variáveis-instrumentais-1" class="slide level2">
<h2>Estimador de Variáveis Instrumentais</h2>
<p>Basta “plugar” os momentos <strong>amostrais</strong>:</p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum_{i=1}^n (z_i - \bar{z})(y_i - \bar{y})}{\sum_{i=1}^n (z_i - \bar{z})(x_i - \bar{x})}\]</span></p>
<ul>
<li class="fragment"><p>A estimativa do intercepto é <span class="math inline">\(\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\)</span></p></li>
<li class="fragment"><p>Dado que ambas as hipóteses 1. e 2. são satisfeitas, dizemos que <strong><em>o estimador de VI é consistente para <span class="math inline">\(\beta_1\)</span></em></strong> e escrevemos: <span class="math display">\[
\text{plim}(\hat{\beta}_1) = \beta_1
\]</span></p></li>
<li class="fragment"><p>em palavras: o <em>limite em probabilidade</em> de <span class="math inline">\(\hat{\beta}_1\)</span> é o verdadeiro <span class="math inline">\(\beta_1\)</span>. O estimador <span class="math inline">\(\hat{\beta}_1\)</span> converge em probabilidade para o parâmetro populacional</p></li>
<li class="fragment"><p>Se isso for verdade, dizemos que este estimador é <strong>consistente</strong>.</p></li>
</ul>
</section>
<section id="inferência-com-variáveis-instrumentais" class="slide level2">
<h2>Inferência com Variáveis Instrumentais</h2>
<p>Assumindo <span class="math inline">\(E(u^2|z) = \sigma^2\)</span> a variância do estimador de VI é:</p>
<p><span class="math display">\[Var(\hat{\beta}_{1,IV}) = \frac{\sigma^2}{n \sigma_x^2 \rho_{x,z}^2}\]</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(\sigma_x^2\)</span> é a variância populacional de <span class="math inline">\(x\)</span>,</p></li>
<li class="fragment"><p><span class="math inline">\(\sigma^2\)</span> é a variância de <span class="math inline">\(u\)</span>, e</p></li>
<li class="fragment"><p><span class="math inline">\(\rho_{x,z}\)</span> é a correlação populacional entre <span class="math inline">\(x\)</span> e <span class="math inline">\(z\)</span>.</p></li>
<li class="fragment"><p>Você pode ver 2 coisas importantes aqui:</p>
<ol type="1">
<li class="fragment">Sem o termo <span class="math inline">\(\rho_{x,z}^2\)</span>, isso é <strong>a variância do MQO</strong>.</li>
<li class="fragment">A medida que o tamanho da amostra <span class="math inline">\(n\)</span> aumenta, a <strong>variância diminui</strong> (assim como no MQO).</li>
</ol></li>
</ul>
</section>
<section id="variância-de-vi-é-sempre-maior-que-mqo" class="slide level2">
<h2>Variância de VI é sempre maior que MQO</h2>
<ul>
<li class="fragment">Compare os estimadores de variância de MQO e VI:</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><span class="math inline">\(Var(\hat{\beta}_{1}) = \frac{\sigma^2}{n \sigma_x^2}\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><span class="math inline">\(Var(\hat{\beta}_{1,IV}) = \frac{\sigma^2}{n \sigma_x^2 \rho_{x,z}^2}\)</span></li>
</ul>
</div>
</div>
<ol type="1">
<li class="fragment"><p>Dado <span class="math inline">\(\rho_{x,z}^2 &lt; 1\)</span> na maioria das situações da vida real, temos que <span class="math inline">\(Var(\hat{\beta}_{1,IV}) &gt; Var(\hat{\beta}_ {1})\)</span> quase certamente.</p></li>
<li class="fragment"><p>Quanto maior a correlação entre <span class="math inline">\(z\)</span> e <span class="math inline">\(x\)</span>, mais próximo o <span class="math inline">\(\rho_{x,z}^2\)</span> está de 1 e voltamos a variância do MQO.</p></li>
</ol>
</section>
<section id="variância-de-vi-é-sempre-maior-que-mqo-1" class="slide level2">
<h2>Variância de VI é sempre maior que MQO</h2>

<img align="center" src="https://media.giphy.com/media/Xg4Lc2tzOXXdNCU4Qc/giphy.gif" width="90" class="r-stretch"><p>Se tiverermos um regressor exógeno válido <span class="math inline">\(x\)</span>, <strong>não</strong> devemos usar VI <span class="math inline">\(z\)</span> para obter <span class="math inline">\(\hat{\beta}\)</span>, pois sua variância será desnecessariamente grande.</p>
</section>
<section id="estimador-de-variância-com-vi" class="slide level2">
<h2>Estimador de variância com VI</h2>
<p>Novamente utilizamos os análogos amostrais</p>
<ul>
<li class="fragment"><span class="math inline">\(n\sigma_x^2\)</span> é a <span class="math inline">\(SQT_x\)</span></li>
<li class="fragment"><span class="math inline">\(\rho_{x,z}^2\)</span> é estimado via <span class="math inline">\(R_{x,z}^2\)</span>. R2 de uma regressão simples de <span class="math inline">\(x\)</span> em <span class="math inline">\(z\)</span></li>
<li class="fragment">a variância de <span class="math inline">\(u\)</span> é obtida através do estimador: <span class="math display">\[\hat{\sigma}^2=\frac{1}{n-2}\sum_{i=1}^{n}\hat{u}_i^2\]</span> onde <span class="math inline">\(\hat{u}_i=y_i-\hat\beta_0-\hat\beta_{1, IV} x_i\)</span></li>
</ul>
</section>
<section id="como-saber-se-a-vi-é-válida" class="slide level2">
<h2>Como Saber se a VI é Válida?</h2>
<ul>
<li class="fragment"><p><strong>Condições para VI</strong></p>
<ol type="1">
<li class="fragment"><strong>Relevância</strong>: <span class="math inline">\(Cov(z,x) \neq 0\)</span></li>
<li class="fragment"><strong>Exclusão</strong>: <span class="math inline">\(Cov(z,u) = 0\)</span></li>
</ol></li>
<li class="fragment"><p>Somente a condição <strong>1.</strong> pode ser testada empiricamente!</p></li>
<li class="fragment"><p><span class="emoji" data-emoji="warning">⚠️</span> Restrição de exclusão é hipótese não testável</p>
<ul>
<li class="fragment">Pesquisador deve se valer de teoria econômica e arguição lógica</li>
</ul></li>
</ul>
</section>
<section id="mínimos-quadrados-em-2-estágios-mq2e" class="slide level2">
<h2>Mínimos Quadrados em 2 Estágios: MQ2E</h2>
<ul>
<li class="fragment"><strong>Equação estrutural</strong>: <span class="math inline">\(y_i=\beta_0+\beta_1 s_i + \beta_2 x_i + u_i\)</span></li>
</ul>
<ol type="1">
<li class="fragment"><p>Estimamos um <strong>modelo de primeiro estágio</strong> que usa apenas variáveis exógenas (como <span class="math inline">\(z\)</span>) para explicar nosso regressor endógeno <span class="math inline">\(s\)</span>.</p></li>
<li class="fragment"><p>Em seguida, usamos a <strong>previsão</strong> do 1º estágio, <span class="math inline">\(\hat{s}\)</span>, no que é chamado de modelo de <strong>segundo estágio</strong>. Esse procedimento deve eliminar qualquer endogeneidade entre <span class="math inline">\(\hat{s}\)</span> e <span class="math inline">\(y\)</span>.</p></li>
</ol>
<div class="fragment">
<p><span class="math display">\[\begin{align}
\text{1. Estágio: }s_i &amp;= \alpha_0 + \alpha_1 z_i + \alpha_2 x_i + \eta_i \\
\text{2. Estágio: }y_i &amp;= \beta_0 + \beta_1 \hat{s}_i + \beta_2 x_i + \varepsilon_i
\end{align}\]</span></p>
</div>
<ul>
<li class="fragment"><p><strong>Condições:</strong></p>
<ol type="1">
<li class="fragment">Relevância do IV: <span class="math inline">\(\alpha_1 \neq 0\)</span></li>
<li class="fragment">Exogeneidade (restrição de exclusão): <span class="math inline">\(E[u | z] = 0\)</span></li>
</ol></li>
</ul>
</section>
<section id="mínimos-quadrados-em-2-estágios-mq2e-1" class="slide level2">
<h2>Mínimos Quadrados em 2 Estágios: MQ2E</h2>
<ul>
<li class="fragment"><p>O primeiro estágio isola a endogeneidade no termo de erro <span class="math inline">\(\eta_i\)</span> <span class="math display">\[s_i=\underbrace{\alpha_0 + \alpha_1 z_i + \alpha_2 x_i}_{\hat{s}_i\text{: parte exógena}} + \eta_i\]</span></p></li>
<li class="fragment"><p>E utiliza somente a parte exógena no segundo estágio! <span class="math display">\[y_i = \beta_0 + \beta_1 \hat{s}_i + \beta_2 x_i + \varepsilon_i\]</span> Assim o segundo estágio faz uso somente de <strong><em>variações exógenas</em></strong> de <span class="math inline">\(s_i\)</span> e, portanto, <span class="math inline">\(\hat{\beta}_1\)</span> será não viesado.</p></li>
<li class="fragment"><p><span class="emoji" data-emoji="warning">⚠️</span> o primeiro estágio <strong>DEVE</strong> ser linear. Caso contrário, regressão proibida de Hausman! (MHE ch.&nbsp;4, p.&nbsp;142)</p></li>
<li class="fragment"><p>Não realizamos manualmente porque os erros padrão no 2º estágio estarão errados</p></li>
</ul>
<div class="fragment">
<center>
<strong>Vejamos em um exemplo</strong>
</center>
</div>
</section>
<section id="vamos-implementar-angrist-e-krueger-1991" class="slide level2">
<h2>Vamos implementar Angrist e Krueger (1991)!</h2>
<h3 id="data-de-nascimento-é-tão-boa-quanto-aleatória">Data de nascimento é tão boa quanto aleatória</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Angrist e Krueger (AK91) é um estudo influente que aborda o viés de habilidade</p>
<ol type="1">
<li class="fragment">construir uma VI que codifique a <em>data de nascimento do aluno</em></li>
<li class="fragment">A criança nascida logo após a data limite começará a escola mais tarde!</li>
</ol></li>
<li class="fragment"><p>Crianças que completam 6 anos até 31 de dezembro devem se matricular na 1ª série em setembro do mesmo ano</p></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Nascidos em dezembro de 2016, estarão com 5a9m quando começarem a escola</p></li>
<li class="fragment"><p>Nascidos em 1º de janeiro de 2017 estarão com 6a9m quando <em>estes</em> entrarem na escola em setembro de 2023</p></li>
<li class="fragment"><p>Podem legalmente abandonar a escola quando fazem 16 anos! Alguns terão mais escolaridade que outros</p></li>
<li class="fragment"><p>VI Dummy para <em>trimestre de nascimento</em>: afeta a escolaridade, mas não está relacionado a <span class="math inline">\(A\)</span>!</p></li>
</ul>
</div>
</div>
</section>
<section id="setup-com-variável-instrumental" class="slide level2">
<h2>Setup com Variável Instrumental</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p><em>trimestre de nascimento</em> dummy <span class="math inline">\(z\)</span>: afeta a escolaridade, mas não está relacionada a <span class="math inline">\(A\)</span>!</p></li>
<li class="fragment"><p>Em particular: se nasceu no 4º trimestre ou não.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><img data-src="img/schooling-dag3.png" style="width:100.0%"></p>
</div>
</div>
</div>
</section>
<section id="dados-sobre-aniversário-e-salários" class="slide level2">
<h2>Dados sobre aniversário e salários</h2>
<p>Vamos carregar os dados e olhar seu sumário</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Dados baixados de https://www.masteringmetrics.com/resources/</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>ak91_file <span class="op">=</span> <span class="st">"../../../data/ak91.dta"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>ak91 <span class="op">=</span> pd.read_stata(ak91_file)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Estatisticas descritivas</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>ak91.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lnw</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">yob</th>
<th data-quarto-table-cell-role="th">qob</th>
<th data-quarto-table-cell-role="th">sob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>329509.000000</td>
<td>329509.000000</td>
<td>329509.000000</td>
<td>329509.000000</td>
<td>329509.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.899943</td>
<td>12.769912</td>
<td>34.602772</td>
<td>2.506429</td>
<td>30.692646</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.678772</td>
<td>3.279323</td>
<td>2.903971</td>
<td>1.111821</td>
<td>14.217417</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-2.341810</td>
<td>0.000000</td>
<td>30.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>5.636505</td>
<td>12.000000</td>
<td>32.000000</td>
<td>2.000000</td>
<td>19.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>5.952494</td>
<td>12.000000</td>
<td>35.000000</td>
<td>3.000000</td>
<td>34.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>6.257376</td>
<td>15.000000</td>
<td>37.000000</td>
<td>3.000000</td>
<td>42.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>10.532100</td>
<td>20.000000</td>
<td>39.000000</td>
<td>4.000000</td>
<td>56.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="transformações-dos-dados" class="slide level2">
<h2>Transformações dos Dados</h2>
<ul>
<li class="fragment"><p>Queremos criar uma <em>dummy</em> <code>q4</code> que é <code>TRUE</code> se você nasceu no 4º trimestre.</p></li>
<li class="fragment"><p>criar versões <code>factor</code> de trimestre e ano de nascimento.</p></li>
</ul>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>ak91[<span class="st">'qob_fct'</span>] <span class="op">=</span> ak91[<span class="st">'qob'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>ak91[<span class="st">'q4'</span>] <span class="op">=</span> (ak91[<span class="st">'qob'</span>] <span class="op">==</span> <span class="fl">4.0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>ak91[<span class="st">'yob_fct'</span>] <span class="op">=</span> ak91[<span class="st">'yob'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>ak91_age <span class="op">=</span> ak91.groupby([<span class="st">'qob'</span>, <span class="st">'yob'</span>]).agg(lnw<span class="op">=</span>(<span class="st">'lnw'</span>, <span class="st">'mean'</span>), s<span class="op">=</span>(<span class="st">'s'</span>, <span class="st">'mean'</span>)).reset_index()</span>
<span id="cb2-6"><a href="#cb2-6"></a>ak91_age[<span class="st">'q4'</span>] <span class="op">=</span> (ak91_age[<span class="st">'qob'</span>] <span class="op">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="primeiro-estágio" class="slide level2">
<h2>Primeiro Estágio!</h2>
<p>Vamos reproduzir agora a primeira figura de AK91 sobre educação em função do trimestre de nascimento!</p>
<div class="columns">
<div class="column" style="width:30%;">
<ol type="1">
<li class="fragment"><p>Os números rotulados significam trimestre de nascimento.</p></li>
<li class="fragment"><p>Nascidos no 4º trimestre <strong>obtiveram</strong> mais educação na maioria dos anos!</p></li>
<li class="fragment"><p><strong>Relevância da VI</strong>.</p></li>
</ol>
</div><div class="column" style="width:70%;">
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">8</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>ak91_age[<span class="st">'yob_qob'</span>] <span class="op">=</span> ak91_age[<span class="st">'yob'</span>] <span class="op">+</span> (ak91_age[<span class="st">'qob'</span>] <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>sort_df <span class="op">=</span> ak91_age.sort_values(<span class="st">'yob_qob'</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>ax.plot(sort_df[<span class="st">'yob_qob'</span>], sort_df[<span class="st">'s'</span>])</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="cf">for</span> i, txt <span class="kw">in</span> <span class="bu">enumerate</span>(sort_df[<span class="st">'qob'</span>].astype(<span class="st">'int'</span>)):</span>
<span id="cb3-9"><a href="#cb3-9"></a>    ax.annotate(txt, (sort_df[<span class="st">'yob_qob'</span>].iloc[i], sort_df[<span class="st">'s'</span>].iloc[i]), </span>
<span id="cb3-10"><a href="#cb3-10"></a>    fontsize<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>    bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round,pad=0.2'</span>, </span>
<span id="cb3-12"><a href="#cb3-12"></a>    fc<span class="op">=</span>sort_df[<span class="st">'q4'</span>].<span class="bu">map</span>({<span class="va">False</span>: <span class="st">'yellow'</span>, <span class="va">True</span>: <span class="st">'purple'</span>}).iloc[i], </span>
<span id="cb3-13"><a href="#cb3-13"></a>    alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>ax.set_xlabel(<span class="st">'Ano de Nascimento'</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a>ax.set_ylabel(<span class="st">'Anos de Escolaridade'</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img data-src="02-IV_pt_files/figure-revealjs/cell-7-output-1.png" width="1118" height="651"></p>
</div>
</div>
</div>
</div>
</section>
<section id="impacto-da-vi-no-resultado" class="slide level2">
<h2>Impacto da VI no resultado</h2>
<p>E quanto aos salários para esses grupos?</p>
<div class="columns">
<div class="column" style="width:30%;">
<ol type="1">
<li class="fragment"><p>Nascidos no 4º trimestre estão entre os mais bem pagos por ano de nascimento.</p></li>
<li class="fragment"><p>Em geral, os salários semanais parecem diminuir um pouco ao longo do tempo.</p></li>
<li class="fragment"><p>Visualização da <strong>forma reduzida</strong></p></li>
</ol>
</div><div class="column" style="width:70%;">
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">8</span>))</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>ax.plot(sort_df[<span class="st">'yob_qob'</span>], sort_df[<span class="st">'lnw'</span>])</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="cf">for</span> i, txt <span class="kw">in</span> <span class="bu">enumerate</span>(sort_df[<span class="st">'qob'</span>].astype(<span class="st">'int'</span>)):</span>
<span id="cb4-6"><a href="#cb4-6"></a>    ax.annotate(txt, (sort_df[<span class="st">'yob_qob'</span>].iloc[i], sort_df[<span class="st">'lnw'</span>].iloc[i]), </span>
<span id="cb4-7"><a href="#cb4-7"></a>    fontsize<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>    bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round,pad=0.2'</span>, </span>
<span id="cb4-9"><a href="#cb4-9"></a>    fc<span class="op">=</span>sort_df[<span class="st">'q4'</span>].<span class="bu">map</span>({<span class="va">False</span>: <span class="st">'yellow'</span>, <span class="va">True</span>: <span class="st">'purple'</span>}).iloc[i], </span>
<span id="cb4-10"><a href="#cb4-10"></a>    alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a>ax.set_xlabel(<span class="st">'Ano de Nascimento'</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a>ax.set_ylabel(<span class="st">'Log Salário Semanal'</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img data-src="02-IV_pt_files/figure-revealjs/cell-8-output-1.png" width="1128" height="651"></p>
</div>
</div>
</div>
</div>
<!-- ## Executando estimativa VI no `R`

<br>
<br>

::::{.columns}
:::{.column width="50%"}
* Várias opções (como sempre com `R`! 😉)

* Usaremos a função [`iv_robust`](https://declaredesign.org/r/estimatr/reference/iv_robust.html) do pacote `estimatr`.

* *Robusto*? Calcula erros padrão que estão corrigindo a heterocedasticidade. [Detalhes aqui.](https://declaredesign.org/r/estimatr/articles/mathematical-notes.html)
:::

:::{.column width="50%"}



```{r mq2e, cache=TRUE}
library(estimatr)
# create a list of models
mod <- list()

# standard (biased!) OLS
mod$ols <- lm(lnw ~ s, data = ak91)

# IV: born in q4 is TRUE?
# doing IV manually in 2 stages.
mod$stage_1 <- lm(s ~ q4, data = ak91)
ak91$shat <- predict(mod$stage_1)  
mod$stage_2 <- lm(lnw ~ shat, data = ak91)

# run 2SLS
# doing IV all in one go
# notice the formula!
# formula = y ~ x | z
mod$MQ2E  <- iv_robust(lnw ~ s | q4,
                       data = ak91,
                       diagnostics = TRUE)
```



:::
:::: -->
</section>
<section id="executando-estimativa-vi-no-python" class="slide level2">
<h2>Executando estimativa VI no <code>Python</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>A melhor biblioteca para implementar estimativas de VI no <code>Python</code> é o <a href="https://bashtage.github.io/linearmodels/"><code>linearmodels</code></a>.</p></li>
<li class="fragment"><p>Usaremos a função <code>IV2SLS</code> que inclui a sintaxe de formula, também usada no <a href="https://www.statsmodels.org/stable/index.html"><code>statsmodels</code></a></p></li>
<li class="fragment"><p><em>Robusto</em>? Calcula <strong>por padrão</strong> erros corrigidos para heterocedasticidade. Argumento <code>cov_type</code>. <a href="#/sec-robust">Section&nbsp;6.1</a></p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> linearmodels.iv <span class="im">as</span> iv</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Standard (biased!) OLS</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>ols <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'lnw ~ 1+s'</span>, data<span class="op">=</span>ak91).fit()</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># IV: born in q4 is TRUE?</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># doing IV manually in 2 stages.</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>stage_1 <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'s ~ 1+q4'</span>, data <span class="op">=</span> ak91).fit()</span>
<span id="cb5-9"><a href="#cb5-9"></a>ak91[<span class="st">'shat'</span>] <span class="op">=</span> stage_1.predict()  </span>
<span id="cb5-10"><a href="#cb5-10"></a>stage_2 <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'lnw ~ 1+shat'</span>, data <span class="op">=</span> ak91).fit()</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># Run 2SLS. Doing IV all in one go</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co"># Notice the formula y ~ [x ~ z]</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>MQ2E <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'lnw ~ 1 + [s ~ q4]'</span>, data <span class="op">=</span> ak91).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<!-- ## Executando estimativa VI no `R`

<br>
<br>

::::{.columns}
:::{.column width="50%"}
* Várias opções (como sempre com `R`! 😉)

* Usará a função [`iv_robust`](https://declaredesign.org/r/estimatr/reference/iv_robust.html) do pacote `estimatr`.

* *Robusto*? Calcula erros padrão que estão corrigindo a heterocedasticidade. [Detalhes aqui.](https://declaredesign.org/r/estimatr/articles/mathematical-notes.html)

* Observe o `predict` para obter $\hat{s}$.
:::


:::{.column width="50%"}



```{r, eval = FALSE}
library(estimatr)
# create a list of models
mod <- list()

# standard (biased!) OLS
mod$ols <- lm(lnw ~ s, data = ak91)

# IV: born in q4 is TRUE?
# doing IV manually in 2 stages.
mod$stage_1 <- lm(s ~ q4, data = ak91)
ak91$shat <- predict(mod$stage_1) #<<
modmod$stage_2 <- lm(lnw ~ shat, data = ak91)

# run 2SLS
# doing IV all in one go
# notice the formula!
# formula = y ~ x | z
mod$MQ2E  <- iv_robust(lnw ~ s | q4,
                       data = ak91,
                       diagnostics = TRUE)
```



:::
::::
 -->
</section>
<section id="resultados" class="slide level2">
<h2>Resultados</h2>
<div class="columns">
<div class="column" style="width:70%;">

<!-- ```{r ms1, echo = FALSE}
glance_custom.iv_robust <- function(x){
  f = x$diagnostic_first_stage_fstatistic
  if (is.null(f)) {
    return()
  } else {
    out <- tibble::tibble(`1. Stage F:` = f["value"])
    return(out)
  }
}
library(huxtable)
tab = msummary(models = mod,
               stars = TRUE,
               statistic = 'std.error',
               gof_omit = 'DF|Deviance|AIC|BIC|R2 Adj.|p.value|F$|se_type|statistic|Log.Lik.|Num.Obs.|N',
               output = "huxtable"
)
tab %>%
  set_bottom_border(row = 9, col = everywhere) %>%
  set_tb_padding(3.5)
``` -->
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="52">
<style type="text/css">
</style>

<table id="T_383c4" data-quarto-postprocess="true" style="font-size: 18pt; text-align: center">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">Model</th>
<th id="T_383c4_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">OLS</th>
<th id="T_383c4_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Stage 1</th>
<th id="T_383c4_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Stage 2</th>
<th id="T_383c4_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">MQ2E</th>
</tr>
<tr class="odd">
<th class="index_name level1" data-quarto-table-cell-role="th">Dep. Var.</th>
<th id="T_383c4_level1_col0" class="col_heading level1 col0" data-quarto-table-cell-role="th">lnw</th>
<th id="T_383c4_level1_col1" class="col_heading level1 col1" data-quarto-table-cell-role="th">s</th>
<th id="T_383c4_level1_col2" class="col_heading level1 col2" data-quarto-table-cell-role="th">lnw</th>
<th id="T_383c4_level1_col3" class="col_heading level1 col3" data-quarto-table-cell-role="th">lnw</th>
</tr>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th"></th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_383c4_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">s</td>
<td id="T_383c4_row0_col0" class="data row0 col0">0.0709***</td>
<td id="T_383c4_row0_col1" class="data row0 col1"></td>
<td id="T_383c4_row0_col2" class="data row0 col2"></td>
<td id="T_383c4_row0_col3" class="data row0 col3">0.0740***</td>
</tr>
<tr class="even">
<td id="T_383c4_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th"></td>
<td id="T_383c4_row1_col0" class="data row1 col0">(0.0004)</td>
<td id="T_383c4_row1_col1" class="data row1 col1"></td>
<td id="T_383c4_row1_col2" class="data row1 col2"></td>
<td id="T_383c4_row1_col3" class="data row1 col3">(0.0280)</td>
</tr>
<tr class="odd">
<td id="T_383c4_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">q4</td>
<td id="T_383c4_row2_col0" class="data row2 col0"></td>
<td id="T_383c4_row2_col1" class="data row2 col1">0.0921***</td>
<td id="T_383c4_row2_col2" class="data row2 col2"></td>
<td id="T_383c4_row2_col3" class="data row2 col3"></td>
</tr>
<tr class="even">
<td id="T_383c4_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th"></td>
<td id="T_383c4_row3_col0" class="data row3 col0"></td>
<td id="T_383c4_row3_col1" class="data row3 col1">(0.0132)</td>
<td id="T_383c4_row3_col2" class="data row3 col2"></td>
<td id="T_383c4_row3_col3" class="data row3 col3"></td>
</tr>
<tr class="odd">
<td id="T_383c4_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">shat</td>
<td id="T_383c4_row4_col0" class="data row4 col0"></td>
<td id="T_383c4_row4_col1" class="data row4 col1"></td>
<td id="T_383c4_row4_col2" class="data row4 col2">0.0740**</td>
<td id="T_383c4_row4_col3" class="data row4 col3"></td>
</tr>
<tr class="even">
<td id="T_383c4_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th"></td>
<td id="T_383c4_row5_col0" class="data row5 col0"></td>
<td id="T_383c4_row5_col1" class="data row5 col1"></td>
<td id="T_383c4_row5_col2" class="data row5 col2">(0.0298)</td>
<td id="T_383c4_row5_col3" class="data row5 col3"></td>
</tr>
<tr class="odd">
<td id="T_383c4_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">====================</td>
<td id="T_383c4_row6_col0" class="data row6 col0">=============</td>
<td id="T_383c4_row6_col1" class="data row6 col1">=============</td>
<td id="T_383c4_row6_col2" class="data row6 col2">=============</td>
<td id="T_383c4_row6_col3" class="data row6 col3">=============</td>
</tr>
<tr class="even">
<td id="T_383c4_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">Instruments</td>
<td id="T_383c4_row7_col0" class="data row7 col0"></td>
<td id="T_383c4_row7_col1" class="data row7 col1"></td>
<td id="T_383c4_row7_col2" class="data row7 col2"></td>
<td id="T_383c4_row7_col3" class="data row7 col3">q4</td>
</tr>
<tr class="odd">
<td id="T_383c4_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">Estimator</td>
<td id="T_383c4_row8_col0" class="data row8 col0">OLS</td>
<td id="T_383c4_row8_col1" class="data row8 col1">OLS</td>
<td id="T_383c4_row8_col2" class="data row8 col2">OLS</td>
<td id="T_383c4_row8_col3" class="data row8 col3">IV-2SLS</td>
</tr>
<tr class="even">
<td id="T_383c4_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">R-squared</td>
<td id="T_383c4_row9_col0" class="data row9 col0">0.1173</td>
<td id="T_383c4_row9_col1" class="data row9 col1">0.0001</td>
<td id="T_383c4_row9_col2" class="data row9 col2">1.865e-05</td>
<td id="T_383c4_row9_col3" class="data row9 col3">0.1171</td>
</tr>
<tr class="odd">
<td id="T_383c4_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">No. Observations</td>
<td id="T_383c4_row10_col0" class="data row10 col0">329509</td>
<td id="T_383c4_row10_col1" class="data row10 col1">329509</td>
<td id="T_383c4_row10_col2" class="data row10 col2">329509</td>
<td id="T_383c4_row10_col3" class="data row10 col3">329509</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:30%;">
<ol type="1">
<li class="fragment"><p>MQO viesado para baixo (erro de medição)</p></li>
<li class="fragment"><p>Primeiro Estágio: VI <code>q4</code> é estatisticamente significativo</p></li>
<li class="fragment"><p>O segundo estágio tem a mesma estimativa pontual que <code>MQ2E</code>, mas um erro padrão diferente (segundo estágio está errado)</p></li>
</ol>
</div>
</div>
</section>
<section id="lembra-da-estatística-f" class="slide level2">
<h2>Lembra da estatística F?</h2>
<ul>
<li class="fragment"><p>Encontramos isso antes: é útil testar modelos restritos versus irrestritos entre si.</p></li>
<li class="fragment"><p>Aqui, estamos interessados em saber se nossos instrumentos são <em>conjuntamente</em> significativos. Claro, com apenas uma VI, isso não é mais informativo do que o t-stat dessa VI.</p></li>
<li class="fragment"><p>Este F-Stat compara o poder preditivo do primeiro estágio com e sem as VIs. Se eles tiverem poder preditivo muito semelhante, o F-stat será baixo e não poderemos rejeitar H0 de que nossas VIs são <strong>conjuntamente insignificantes</strong> no modelo do primeiro estágio. 😞</p></li>
</ul>
</section>
<section id="vi-com-um-instrumento-fraco" class="slide level2">
<h2>VI com um instrumento fraco</h2>
<ul>
<li class="fragment"><p>VI é consistente sob determinadas premissas.</p></li>
<li class="fragment"><p>No entanto, <em>mesmo</em> que tenhamos apenas <span class="math inline">\(Cor(z,u)\)</span> muito pequenos, podemos errar</p></li>
<li class="fragment"><p>Pequena correlação entre <span class="math inline">\(x\)</span> e <span class="math inline">\(z\)</span> pode produzir estimativas <strong>inconsistentes</strong>. <span class="math display">\[\text{plim}(\hat{\beta}_{1,IV}) = \beta_1 + \frac{Cor(z,u)}{Cor(z,x)} \cdot \frac{\sigma_u}{\sigma_x}\]</span></p></li>
<li class="fragment"><p>Mesmo que <span class="math inline">\(Cor(z,u)\)</span> seja muito pequena</p></li>
<li class="fragment"><p>Um <strong>instrumento fraco</strong> é aquele com pequeno valor absoluto para <span class="math inline">\(Cor(z,x)\)</span></p></li>
<li class="fragment"><p>Mesmo com um tamanho de amostra grande, nosso estimador <em>não</em> convergirá para o verdadeiro parâmetro populacional <span class="math inline">\(\beta_1\)</span>.</p></li>
</ul>
</section>
<section id="vi-com-um-instrumento-fraco-1" class="slide level2">
<h2>VI com um instrumento fraco</h2>
<p>Para ilustrar esse ponto, vamos supor que queremos analisar o impacto do número de maços de cigarros fumados por dia por mulheres grávidas (<em>packs</em>) no peso ao nascer de seus filhos (<em>bwght</em>):</p>
<p><span class="math display">\[\log(bwght) = \beta_0 + \beta_1 packs + u\]</span></p>
<p>Estamos preocupados que o comportamento de fumar esteja correlacionado com uma série de outras variáveis relacionadas à saúde que estão em <span class="math inline">\(u\)</span> e que podem afetar o peso ao nascer da criança.</p>
<p>Então, procuramos uma <strong>VI</strong>. Suponha que usemos o <strong>preço dos cigarros</strong> (<em>cigprice</em>), supondo que o preço dos cigarros não esteja correlacionado com fatores em <span class="math inline">\(u\)</span>. Vamos executar o primeiro estágio de <em>cigprice</em> em <em>packs</em> e então vamos mostrar as estimativas de MQ2E:</p>
</section>
<section id="vi-com-um-instrumento-fraco-2" class="slide level2">
<h2>VI com um instrumento fraco</h2>

<!-- 


```xvxets
data(bwght, package = "wooldridge")
mods <- list()
mods$Estagio_1 <- lm(packs ~ cigprice, data = bwght)
mods$VI <- estimatr::iv_robust(log(bwght) ~  packs | cigprice, data = bwght, 
                               diagnostics = TRUE)
```

```{r,echo = FALSE}
tbl <- modelsummary(mods, gof_omit = 'DF|Deviance|AIC|BIC|R2 Adj.|p.value|F$|se_type|statistic|Log.Lik.|Num.Obs.|N', output = "huxtable") %>%
    set_bottom_border(row = 7, col = everywhere) %>%
    set_bold(1, everywhere) %>%
    set_tb_padding(5)
font_size(tbl) <- 15
tbl
``` -->
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb6-2"><a href="#cb6-2"></a>bwght <span class="op">=</span> woo.dataWoo(<span class="st">'bwght'</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>estagio_1 <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'packs ~ 1 + cigprice'</span>, data <span class="op">=</span> bwght).fit()</span>
<span id="cb6-4"><a href="#cb6-4"></a>vi <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'np.log(bwght) ~ 1 + [packs ~ cigprice]'</span>, data <span class="op">=</span> bwght).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="54">
<style type="text/css">
</style>

<table id="T_e5f4c" data-quarto-postprocess="true" style="font-size: 18pt; text-align: center">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">Model</th>
<th id="T_e5f4c_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Estágio 1</th>
<th id="T_e5f4c_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">VI</th>
</tr>
<tr class="odd">
<th class="index_name level1" data-quarto-table-cell-role="th">Dep. Var.</th>
<th id="T_e5f4c_level1_col0" class="col_heading level1 col0" data-quarto-table-cell-role="th">packs</th>
<th id="T_e5f4c_level1_col1" class="col_heading level1 col1" data-quarto-table-cell-role="th">np.log(bwght)</th>
</tr>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th"></th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e5f4c_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cigprice</td>
<td id="T_e5f4c_row0_col0" class="data row0 col0">0.0003</td>
<td id="T_e5f4c_row0_col1" class="data row0 col1"></td>
</tr>
<tr class="even">
<td id="T_e5f4c_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th"></td>
<td id="T_e5f4c_row1_col0" class="data row1 col0">(0.0008)</td>
<td id="T_e5f4c_row1_col1" class="data row1 col1"></td>
</tr>
<tr class="odd">
<td id="T_e5f4c_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">packs</td>
<td id="T_e5f4c_row2_col0" class="data row2 col0"></td>
<td id="T_e5f4c_row2_col1" class="data row2 col1">2.9887</td>
</tr>
<tr class="even">
<td id="T_e5f4c_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th"></td>
<td id="T_e5f4c_row3_col0" class="data row3 col0"></td>
<td id="T_e5f4c_row3_col1" class="data row3 col1">(8.9832)</td>
</tr>
<tr class="odd">
<td id="T_e5f4c_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">====================</td>
<td id="T_e5f4c_row4_col0" class="data row4 col0">=============</td>
<td id="T_e5f4c_row4_col1" class="data row4 col1">=================</td>
</tr>
<tr class="even">
<td id="T_e5f4c_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">Instruments</td>
<td id="T_e5f4c_row5_col0" class="data row5 col0"></td>
<td id="T_e5f4c_row5_col1" class="data row5 col1">cigprice</td>
</tr>
<tr class="odd">
<td id="T_e5f4c_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">Estimator</td>
<td id="T_e5f4c_row6_col0" class="data row6 col0">OLS</td>
<td id="T_e5f4c_row6_col1" class="data row6 col1">IV-2SLS</td>
</tr>
<tr class="even">
<td id="T_e5f4c_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">R-squared</td>
<td id="T_e5f4c_row7_col0" class="data row7 col0">9.417e-05</td>
<td id="T_e5f4c_row7_col1" class="data row7 col1">-23.230</td>
</tr>
<tr class="odd">
<td id="T_e5f4c_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">No. Observations</td>
<td id="T_e5f4c_row8_col0" class="data row8 col0">1388</td>
<td id="T_e5f4c_row8_col1" class="data row8 col1">1388</td>
</tr>
<tr class="even">
<td id="T_e5f4c_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">F-statistic</td>
<td id="T_e5f4c_row9_col0" class="data row9 col0">0.1213</td>
<td id="T_e5f4c_row9_col1" class="data row9 col1">0.1107</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="vi-com-um-instrumento-fraco-3" class="slide level2">
<h2>VI com um instrumento fraco</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>A primeira coluna mostra: primeiro estágio muito fraco. <em>cigprice</em> parece ter zero impacto na quantidade de maços consumidos!</p></li>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> é zero.</p></li>
<li class="fragment"><p>Por quê usamos esta VI?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>na segunda coluna: impacto muito grande e positivo(!) dos maços fumados no peso ao nascer. 🤔</p></li>
<li class="fragment"><p>Enorme erro padrão.</p></li>
<li class="fragment"><p>Um <span class="math inline">\(R^2\)</span> de -23?!</p></li>
<li class="fragment"><p>F-stat do primeiro estágio: 0,121. Corresponde a um valor p de 0.728 : nós <strong>não podemos</strong> rejeitar a H0 de um primeiro estágio insignificante.</p></li>
<li class="fragment"><p>Então: abordagem <strong>inválida</strong>. ❌</p></li>
</ul>
</div>
</div>
</section>
<section id="variáveis-de-controle-adicionais" class="slide level2">
<h2>Variáveis de Controle Adicionais</h2>
<ul>
<li class="fragment"><p>Vimos uma tendência de tempo clara na educação mais cedo.</p></li>
<li class="fragment"><p>Há também flutuações do ciclo de negócios nos ganhos</p></li>
<li class="fragment"><p>Devemos de alguma forma controlar por diferentes períodos de tempo.</p></li>
<li class="fragment"><p>Além disso, podemos usar mais de uma VI! Aqui está como:</p></li>
</ul>
</section>
<section id="variáveis-de-controle-adicionais-1" class="slide level2">
<h2>Variáveis de Controle Adicionais</h2>
<!-- ```{r mq2e2, cache=TRUE}
# we keep adding to our `mod` list:
mod$ols_yr  <- update(mod$ols, . ~ . + yob_fct)  #  previous OLS model

# add exogenous vars on both sides of the `|` !
mod$MQ2E_yr <- iv_robust(lnw ~ s  + yob_fct | q4 + yob_fct, 
                         data = ak91, diagnostics = TRUE ) 

# use all quarters as IVs
mod$MQ2E_all <- iv_robust(lnw ~ s  + yob_fct | qob_fct + yob_fct, 
                          data = ak91, diagnostics = TRUE  )
``` -->
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>ols_yr <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'lnw ~ 1+s+yob_fct'</span>, data<span class="op">=</span>ak91).fit()</span>
<span id="cb7-2"><a href="#cb7-2"></a>mq2e_yr <span class="op">=</span> iv.IV2SLS.from_formula(<span class="st">'lnw ~ 1+yob_fct+[s ~ q4]'</span>, data<span class="op">=</span>ak91).fit()</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Use all quarters as IVs</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># mq2e_all = iv.IV2SLS.from_formula('lnw ~ 1+yob_fct+[s ~ qob_fct]', data=ak91).fit()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="variáveis-de-controle-adicionais-2" class="slide level2">
<h2>Variáveis de Controle Adicionais</h2>

<!-- ```{r, echo = FALSE}
# here is how to make the table:
rows <- data.frame(term = c("Instruments","Year of birth"),
                   ols  = c("none","no"),
                   SLS  = c("Q4","no"),
                   ols_yr  = c("none","yes"),
                   SLS_yr  = c("Q4","yes"),
                   SLS_all  = c("All Quarters","yes")
                   )
names(rows)[c(3,5,6)] <- c("2SLS","2SLS_yr","2SLS_all")
tab = msummary(models = mod[c("ols","MQ2E","ols_yr","MQ2E_yr","MQ2E_all")], 
               statistic = 'std.error',
               gof_map = gm,
               add_rows = rows,
               coef_omit = 'yob_fct',
               output = 'huxtable')

htab = tab %>%
  set_bottom_border(row = 6, col = everywhere) %>%
  set_bold(1, everywhere) %>%
  set_tb_padding(4)

htab
``` -->
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="56">
<style type="text/css">
</style>

<table id="T_161f1" data-quarto-postprocess="true" style="font-size: 18pt; text-align: center">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">Model</th>
<th id="T_161f1_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">OLS</th>
<th id="T_161f1_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">MQ2E</th>
<th id="T_161f1_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">OLS + Year</th>
<th id="T_161f1_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">MQ2E + Year</th>
</tr>
<tr class="odd">
<th class="index_name level1" data-quarto-table-cell-role="th">Dep. Var.</th>
<th id="T_161f1_level1_col0" class="col_heading level1 col0" data-quarto-table-cell-role="th">lnw</th>
<th id="T_161f1_level1_col1" class="col_heading level1 col1" data-quarto-table-cell-role="th">lnw</th>
<th id="T_161f1_level1_col2" class="col_heading level1 col2" data-quarto-table-cell-role="th">lnw</th>
<th id="T_161f1_level1_col3" class="col_heading level1 col3" data-quarto-table-cell-role="th">lnw</th>
</tr>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th"></th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_161f1_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">s</td>
<td id="T_161f1_row0_col0" class="data row0 col0">0.0709***</td>
<td id="T_161f1_row0_col1" class="data row0 col1">0.0740***</td>
<td id="T_161f1_row0_col2" class="data row0 col2">0.0711***</td>
<td id="T_161f1_row0_col3" class="data row0 col3">0.0752***</td>
</tr>
<tr class="even">
<td id="T_161f1_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th"></td>
<td id="T_161f1_row1_col0" class="data row1 col0">(0.0004)</td>
<td id="T_161f1_row1_col1" class="data row1 col1">(0.0280)</td>
<td id="T_161f1_row1_col2" class="data row1 col2">(0.0004)</td>
<td id="T_161f1_row1_col3" class="data row1 col3">(0.0284)</td>
</tr>
<tr class="odd">
<td id="T_161f1_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">Estimator</td>
<td id="T_161f1_row2_col0" class="data row2 col0">OLS</td>
<td id="T_161f1_row2_col1" class="data row2 col1">IV-2SLS</td>
<td id="T_161f1_row2_col2" class="data row2 col2">OLS</td>
<td id="T_161f1_row2_col3" class="data row2 col3">IV-2SLS</td>
</tr>
<tr class="even">
<td id="T_161f1_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">Adj. R-squared</td>
<td id="T_161f1_row3_col0" class="data row3 col0">0.1173</td>
<td id="T_161f1_row3_col1" class="data row3 col1">0.1171</td>
<td id="T_161f1_row3_col2" class="data row3 col2">0.1177</td>
<td id="T_161f1_row3_col3" class="data row3 col3">0.1173</td>
</tr>
<tr class="odd">
<td id="T_161f1_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">No. Observations</td>
<td id="T_161f1_row4_col0" class="data row4 col0">329509</td>
<td id="T_161f1_row4_col1" class="data row4 col1">329509</td>
<td id="T_161f1_row4_col2" class="data row4 col2">329509</td>
<td id="T_161f1_row4_col3" class="data row4 col3">329509</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:30%;">
<p><strong>Adicionando controle de ano</strong>…</p>
<ul>
<li class="fragment">deixa o MQO praticamente inalterado</li>
<li class="fragment">ligeiro aumento na estimativa de MQ2E</li>
</ul>
<!-- **Usando todos os trimestres como VI**...

* Aumenta muito a precisão da estimativa MQ2E!
* A estimativa pontual é de 10,5% agora! -->
</div>
</div>
</section>
<section id="fazendo-um-balanço---o-trimestre-de-nascimento-qob" class="slide level2">
<h2>Fazendo um balanço - O Trimestre de Nascimento (QOB)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">Isso produzirá estimativas consistentes se
<ol type="1">
<li class="fragment">A VI prediz bem o regressor endógeno.</li>
<li class="fragment">A VI é tão boa quanto aleatória/independente das VOs.</li>
<li class="fragment">Só pode impactar o resultado através da escolaridade.</li>
</ol></li>
<li class="fragment">Como o QOB se comporta com relação a estes itens?</li>
</ul>
</div><div class="column" style="width:50%;">
<ol type="1">
<li class="fragment"><p>O gráfico do 1º estágio e o F-stat alto oferecem evidências de <strong>relevância</strong>. ✅</p></li>
<li class="fragment"><p>O QOB é <strong>independente</strong> de, digamos, <em>características maternas</em>? Aniversários não são realmente aleatórios - há épocas de nascimento para certas origens socioeconômicas. maior escolaridade materna dão à luz no segundo trimestre. (não no 4º! ✅)</p></li>
<li class="fragment"><p>Exclusão: E se as crianças mais novas (nascidas no 4º tri!) forem desfavorecidas desde o início, que tem impactos negativos a longo prazo? Então <span class="math inline">\(E[u|z] \neq 0\)</span>! Bem, os mais novos se saem melhor (mais escolaridade e salário mais alto)! ✅</p></li>
</ol>
</div>
</div>
</section></section>
<section>
<section id="tópicos-especiais-vi" class="title-slide slide level1 center">
<h1>Tópicos Especiais VI</h1>

</section>
<section id="experimentos-aleatorizados" class="slide level2">
<h2>Experimentos Aleatorizados</h2>
<ul>
<li class="fragment"><p>Experimento aleatorizado (RCT ou A/B testing)</p></li>
<li class="fragment"><p>Atribui indíviduos para grupos Controle ou Tratado, mas não obriga</p></li>
<li class="fragment"><p>Existe <em>noncompliance</em>. Tratamento efetivo <span class="math inline">\(T_i \neq Z_i\)</span> designação</p></li>
<li class="fragment"><p><strong>Atribuição ao tratamento</strong> <span class="math inline">\(Z_i\)</span> serve como <strong>instrumento</strong> para o efetivo status <span class="math inline">\(T_i\)</span></p></li>
</ul>
</section></section>
<section>
<section id="tópicos-especiais-vi-1" class="title-slide slide level1 center">
<h1>Tópicos Especiais VI</h1>

</section>
<section id="experimentos-aleatorizados-1" class="slide level2">
<h2>Experimentos Aleatorizados</h2>
<ul>
<li class="fragment">Duas medidas de tratamento
<ul>
<li class="fragment">Intention-to-treat (<strong>ITT</strong>): forma reduzida <span class="math inline">\(Y_i=\pi Z_i+v_i\)</span></li>
<li class="fragment">Local Average Treatment Effect (<strong>LATE</strong>): variável instrumental (MQ2E)</li>
</ul></li>
<li class="fragment">Para validade do experimento, checa-se o balanço de covariadas entre grupo controle e tratamento</li>
<li class="fragment">Bom balanço <span class="math inline">\(\implies\)</span> aleatorização bem feita. (Imbens e Rubin, 2015)</li>
</ul>
</section></section>
<section>
<section id="tópicos-especiais-vi-2" class="title-slide slide level1 center">
<h1>Tópicos Especiais VI</h1>

</section>
<section id="instrumentos-de-bartik" class="slide level2">
<h2>Instrumentos de Bartik</h2>
<blockquote>
<p>A ideia por trás de um instrumento de Bartik é medir variações locais a partir de um choque nacional (regional)</p>
</blockquote>
<ul>
<li class="fragment"><p>Também conhecidos como <strong><em>Shift-Share design</em></strong></p></li>
<li class="fragment"><p>Comuns na literatura de comércio internacional (Autor, Dorn, e Hanson, 2013), imigração (Card, 2009) e trabalho (Bound e Holzer, 2000)</p></li>
<li class="fragment"><p><strong><em>Bartik Instruments: What, When, Why, and How</em></strong>. Goldsmith-Pinkham, et al.&nbsp;(2020)</p></li>
</ul>
</section></section>
<section>
<section id="tópicos-especiais-vi-3" class="title-slide slide level1 center">
<h1>Tópicos Especiais VI</h1>

</section>
<section id="instrumentos-de-bartik-1" class="slide level2">
<h2>Instrumentos de Bartik</h2>
<ul>
<li class="fragment"><p>Um choque nacional (<em><strong>shifter</strong></em>), em diferentes indústrias, é “espalhado” localmente de forma diferente entre as localidades através de uma matriz de exposições (<em><strong>shares</strong></em>)</p></li>
<li class="fragment"><p>Crescimento do salário em razão do crescimento no emprego, em uma localidade <span class="math inline">\(l\)</span> <span class="math display">\[y_l=\rho+\beta_1x_l+\epsilon_l\]</span></p></li>
<li class="fragment"><p>Crescimento do emprego é <em>produto interno</em> da fração de cada indústria <span class="math inline">\(k\)</span> no emprego com o crescimento desta indústria. <span class="math inline">\(x_l=\sum_kz_{lk}g_{lk}\)</span></p></li>
<li class="fragment"><p>Crescimento da indústria local é decomposto: <span class="math inline">\(g_{lk}=g_k+\tilde{g}_{lk}\)</span></p></li>
<li class="fragment"><p>O <strong><em>Instrumento de Bartik</em></strong> é: <span class="math display">\[Z_l=\sum_k z_{lk}g_k\]</span></p></li>
</ul>
</section>
<section id="leitura-recomendada" class="slide level2">
<h2><span class="emoji" data-emoji="books">📚</span> Leitura Recomendada</h2>
<ul>
<li class="fragment"><p>WOOLDRIDGE, Jeffrey M. Introdução à econometria: uma abordagem moderna. São Paulo: Cengage Learning, 2016. Tradução da 4ª edição norte-americana por José Antonio Ferreira. Capítulo 15.</p></li>
<li class="fragment"><p>GUJARATI, Damodar N.; PORTER, Dawn C. Econometria básica. Porto Alegre: Amgh Editora, 2011. - 5. ed.&nbsp;Capítulo 17</p></li>
<li class="fragment"><p>ANGRIST, Joshua D.; PISCHKE, Jörn-Steffen. Mostly harmless econometrics: An empiricist’s companion. Princeton university press, 2009.</p></li>
<li class="fragment"><p>IMBENS, Guido W.; RUBIN, Donald B. Causal inference in statistics, social, and biomedical sciences. Cambridge University Press, 2015.</p></li>
<li class="fragment"><p>GOLDSMITH-PINKHAM, Paul; SORKIN, Isaac; SWIFT, Henry. Bartik instruments: What, when, why, and how. American Economic Review, v. 110, n.&nbsp;8, p.&nbsp;2586-2624, 2020.</p></li>
</ul>
</section>
<section id="até-a-próxima-aula" class="slide level2">
<h2>ATÉ A PRÓXIMA AULA!</h2>
<div class="footer">
<p>[1]: Este slides foram baseados nas aulas de econometria da <a href="https://github.com/ScPoEcon/ScPoEconometrics-Slides">SciencesPo Department of Economics</a></p>
</div>
</section></section>
<section>
<section id="apêndice" class="title-slide slide level1 center">
<h1>Apêndice</h1>

</section>
<section id="sec-robust" class="slide level2">
<h2>Erros Padrão Robustos</h2>
<ul>
<li class="fragment"><p>Resíduos representa a diferença entre a variável dependente o a média estimada.<sup>1</sup> <span class="math display">\[
\begin{aligned}
y = X\hat\beta + \hat{u}\\
\hat{u} = y − X\hat{\beta}
\end{aligned}
\]</span></p></li>
<li class="fragment"><p>Variância de depende dos erros. <span class="math display">\[
\begin{aligned}
Var(\hat{\beta}\mid X) &amp;= E[(X'X)^{-1}X'uu'X(X'X)^{-1}\mid X]\\
&amp;= (X'X)^{-1}X'E[uu'\mid X]X(X'X)^{-1}\\
&amp;= (X'X)^{-1}X'\Sigma X(X'X)^{-1}\\
\end{aligned}
\]</span></p></li>
<li class="fragment"><p><span class="math inline">\(\Sigma=E[uu'\mid X]\)</span>. Uma matriz <span class="math inline">\(n\times n\)</span></p></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Notação matricial, y é um vetor de <span class="math inline">\(n\times 1\)</span>, X é uma matriz <span class="math inline">\(n\times k\)</span>, é um vetor <span class="math inline">\(k\times 1\)</span> e u é um vetor <span class="math inline">\(n\times 1\)</span>.</p></li></ol></aside></section>
<section id="erros-padrão-robustos" class="slide level2">
<h2>Erros Padrão Robustos</h2>
<ul>
<li class="fragment"><p>Se os erros são <strong>homocedásticos</strong>, então <span class="math inline">\(\Sigma=\sigma^2I_n\)</span> e o estimador de variância do MQO: <span class="math inline">\(\hat{V}^{mqo}(\hat{\beta}\mid X)=\hat\sigma^2(X'X)^{-1}\)</span>.</p></li>
<li class="fragment"><p>Se os erros são <strong>heterocedásticos</strong>, o <strong><em>estimador de variância</em></strong> do MQO é inconsistente!</p>
<ul>
<li class="fragment">Veja que o estimador de MQO de <span class="math inline">\(\beta\)</span> ainda é consistente</li>
</ul></li>
<li class="fragment"><p>O <strong>estimador de variância robusto</strong> a heterocedasticidade proposto por White é: <span class="math display">\[
\begin{aligned}
\hat{V}^{rob}(\hat{\beta}\mid X) &amp;= (X'X)^{-1}X'\hat{\Sigma}X(X'X)^{-1}\\
\hat{\Sigma} &amp;= \begin{bmatrix}
\hat{u}_1^2 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; \hat{u}_2^2 &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; \cdots &amp; \hat{u}_n^2\\
\end{bmatrix}
\end{aligned}
\]</span></p></li>
</ul>

<img src="img/UdescEsag.jpeg" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="02-IV_pt_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="02-IV_pt_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="02-IV_pt_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="02-IV_pt_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>